---
author: xnzone
title: "分布式系统概览"
date: 2024-09-10 10:23:32
image: /covers/distr-fun-zh.jpg
cover: false
weight: 401
tags:
  - distributed
  - system
  - CAP
  - 分布式系统
---

任何计算机系统的两项基本任务是：
- 存储
- 计算

分布式编程的艺术在于：使用多台计算机解决原本可以在单台计算机上完成的问题——通常是因为问题的规模超出了单台计算机的能力

实际上，并没有什么强制要求必须使用分布式系统。在理论上，如果拥有无限资金和研发时间，就不需要分布式系统。所有的存储和计算都可以交给一个“魔法盒”完成——*一个速度极快且高度可靠的单一系统，而且还有人帮你设计好*

然而，现实中很少有人拥有无限资源。因此我们需要在实际成本收益曲线中找到一个平衡点。在小规模下的情况下，升级软件是一种可行的策略。然而随着问题规模的增大，会达到瓶颈，此时，要么没有可以让你在单个节点上解决问题的硬件升级，要么这种升级变得成本过高。此时，欢迎你来到分布式系统的世界。

在现实场景中，中端通用硬件具有最佳性价比 -- 只要能通过软件容错降低维护成本。

计算主要受益于高端硬件，前提是它们能将慢速网络访问替换为内部内存访问。在需要大量节点通信的任务中，高端硬件的性能优势是有限的。

![](https://s2.loli.net/2024/11/18/rt2wExMBfbcoGT9.png)

如上图所示，来自[Barroso, Clidaras & Hölzle](http://www.morganclaypool.com/doi/abs/10.2200/S00516ED2V01Y201306CAC024)的研究表明，假设所有节点都采用统一的内存访问模式，高端硬件与通用硬件之间的性能差距会随着集群规模的增加而减少。


理想情况下，添加一台机器应当能够线性地提高系统的性能和容量。然而，实际上这是不可能的，因为存在由于拥有独立计算机而产生的某些开销。数据需要在各个节点之间复制，计算任务需要协调等等。这就是为什么学习分布式算法是值得的 ———— 它们提供了针对特定问题的搞笑解决方案，以及关于什么是可能的、正确实现的最低成本是什么、以及什么是不可能的指导

本文的重点是分布式编程和系统，场景虽然普通，但在商业上具有重要意义：数据中心。例如，我不会讨论由于特殊的网络配置或共享内存环境而引发的特定问题。此外，本文着重于探索系统设计领域，而不是优化某个特定设计 ———— 后者属于更专业的主题。

## 我们要实现的目标：可扩展性以及其他优势

在我看来，这一切都要源自于规模大小

大多数事情在小规模时都很简单，但同样的问题一旦超过某个规模、体积或其他物理限制，就会变得更加简单。举个例子，搬动一块巧克力很容易，搬动一座山就很难。数清楚房间里有多少人很简单，但要数清楚一个国家有多少人就很难。

因此，一切的起点是规模 ———— 可扩展性。通俗地说，在一个可扩展的系统中，当我们从小规模扩展到大规模时，情况不应该逐步恶化。这里还有一个定义：

[可扩展性](https://en.wikipedia.org/wiki/Scalability)

是指一个系统、网络或流程以高效的方式处理不断增加的工作量的能力，或其能够扩展以适应这种增长的能力。

那么，究竟是什么在增长？实际上，增长可以用几乎任何指标来衡量（如人数、电力消耗等）。但有三个特别值得关注的方面：

- **规模可扩展性**：增加更多节点应使系统性能线性提升；数据集的增长不应显著增加延迟。
- **地理可扩展性**：系统应能利用多个数据中心来减少响应用户查询所需的时间，同时以合理的方式处理跨数据中心的延迟。
- **管理可扩展性**：增加更多节点不应显著增加系统的管理成本（例如，管理员与机器的比例应保持平稳）。

当然，在实际系统中，增长通常会同时发生在多个不同的维度上；每个指标仅捕捉了增长的某个方面。

一个可扩展的系统是指在规模不断扩大时，仍能持续满足用户